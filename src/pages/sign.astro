---
import MainLayout from "../layouts/MainLayout.astro";
const logoUrl =
  "https://raw.githubusercontent.com/Harikar-NGO/harikar-website-files/main/images/harikar-logo-sign.png";

const imgStyle = {
  display: "block",
  "image-rendering": "-webkit-optimize-contrast",
  "min-width": "100%",
  height: "auto",
};

const nameStyle = {
  "font-weight": 700,
  "font-size": "16px",
  "line-height": "19px",
  color: "#4b60a5",
  whitespace: "nowrap",
  padding: "0px 0px 4px 0px",
  "text-transform": "capitalize",
};

const jobTitleStyle = {
  "font-weight": 700,
  "font-size": "10px",
  "line-height": "12px",
  color: "#000000",
  whitespace: "nowrap",
  padding: "0px 0px 4px 0px",
  "text-transform": "uppercase",
};

const fieldStyle = {
  padding: "0px",
  "font-weight": 500,
  "font-size": "10px",
  color: "#000000",
  "line-height": "12px",
  whitespace: "nowrap",
};

const emailStyle = {
  padding: "0px",
  "font-size": "10px",
  "line-height": "12px",
};

const emailAnchorStyle = {
  "font-weight": 700,
  color: "#ff7f26",
  "text-decoration": "none",
};

const addressStyle = {
  padding: "0px",
  "font-size": "10px",
  "line-height": "12px",
  color: "#4b60a5",
};
---

<MainLayout title="email signature page">
  <div class="main-wrap">
    <div class="form">
      <h2>Enter Details</h2>
      <form>
        <div class="form-item">
          <label for="name">Name*</label>
          <input
            type="text"
            name="name"
            id="nameInput"
            required
            placeholder="John Doe"
          />
        </div>
        <div class="form-item">
          <label for="job">Job Title*</label>
          <input
            type="text"
            name="job"
            id="jobInput"
            required
            placeholder="Reporting Officer"
          />
        </div>
        <div class="form-item">
          <label for="email">Email*</label>
          <p class="help">Enter your harikar email.</p>
          <input
            type="text"
            name="email"
            placeholder="@harikar.org"
            id="emailInput"
            pattern="[0-9A-Za-z-._]+@harikar.org"
            required
          />
        </div>
        <div class="form-item">
          <label for="phone">Mobile Number*</label>
          <p class="help">Enter valid phone number, example: 750-000-0000.</p>
          <input
            type="text"
            name="phone"
            placeholder="750-000-0000"
            pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}"
            id="mobileInput"
            required
          />
        </div>
        <div class="form-item">
          <label for="skype">Skype ID*</label>
          <input
            type="text"
            name="skype"
            id="skypeInput"
            required
            placeholder="john.doe"
          />
        </div>
        <div class="btns">
          <button class="btn primary-btn" id="textButton">Copy Signature</button
          >
          <button class="btn secondary-btn" id="htmlButton">Copy HTML</button>
        </div>
      </form>
    </div>

    <div class="preview" id="preview">
      <h2>Signature Preview</h2>
      <div class="preview-card" id="preview-card">
        <table cellspacing="0" cellpadding="0">
          <tr>
            <td style={{ "vertical-align": "middle" }}>
              <img
                src={logoUrl}
                width="50"
                height="88"
                class="img"
                style={imgStyle}
              />
            </td>
            <td>
              <table
                cellspacing="0"
                cellpadding="0"
                style={{ margin: "1.5px 0px" }}
              >
                <tr>
                  <td style={{ width: "24px" }}> &nbsp;</td>
                  <td style={{ "border-left": "1px solid #d1dbe5" }}></td>
                  <td style={{ width: "24px" }}> &nbsp;</td>
                </tr>
              </table>
            </td>
            <td>
              <table cellspacing="0" cellpadding="0">
                <tr>
                  <td id="nameField" style={nameStyle}>Name</td>
                </tr>
                <tr>
                  <td id="jobField" style={jobTitleStyle}>Job Title</td>
                </tr>
                <tr>
                  <td id="mobileField" style={fieldStyle}>
                    <strong style={{ color: "#4b60a5" }}>Mobile:</strong>
                     +964-773-000-0000
                  </td>
                </tr>
                <tr>
                  <td id="emailField" style={fieldStyle}>
                    <strong style={{ color: "#4b60a5" }}>Email:</strong>
                     email@harikar.org
                  </td>
                </tr>
                <tr>
                  <td id="skypeField" style={fieldStyle}>
                    <strong style={{ color: "#4b60a5" }}>Skype ID:</strong>
                     skypeId
                  </td>
                </tr>
                <tr>
                  <td style={emailStyle}>
                    <a href="https://www.harikar.org" style={emailAnchorStyle}
                      >www.harikar.org</a
                    >
                  </td>
                </tr>
                <tr style={addressStyle}>
                  <td>Australia Streat/Media Quarter, 99448 Duhok, KRI-Iraq</td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </div>
    </div>

    <div class="integrations">
      <h2>Add signature in Outlook</h2>
      <ol>
        <li>Click on Copy Signature and open Outlook.</li>
        <li>Select file / Options.</li>
        <li>Select Mail then signature</li>
        <li>Click new, and give the signature a name.</li>
        <li>paste the signature and click ok</li>
        <li>
          Choose your new default signature for New messages and
          Replies/forwards.
        </li>
      </ol>
      <h2>Add signature in Gmail</h2>
      <ol>
        <li>Click on Copy Signature and go to your work Gmail account.</li>
        <li>Select the Settings gear in your Gmail toolbar.</li>
        <li>Select See All Settings / General / Signature.</li>
        <li>Select + Create New button.</li>
        <li>Give this signature a name and select Create.</li>
        <li>
          Paste the signature in the box on the right and set siganture
          defaults.
        </li>
        <li>Select your new default signature under Signature defaults.</li>
        <li>Scroll to bottom and select Save Changes.</li>
      </ol>
      <div class="note">
        <p>
          <em
            >Depending on the version of outlook you have installed, some steps
            might be different for you</em
          >
        </p>
      </div>
    </div>
  </div>
</MainLayout>

<script lang="js" is:inline>
  const nameInput = document.getElementById("nameInput");
  const nameField = document.getElementById("nameField");
  const jobInput = document.getElementById("jobInput");
  const jobField = document.getElementById("jobField");
  const emailInput = document.getElementById("emailInput");
  const emailField = document.getElementById("emailField");
  const mobileInput = document.getElementById("mobileInput");
  const mobileField = document.getElementById("mobileField");
  const skypeInput = document.getElementById("skypeInput");
  const skypeField = document.getElementById("skypeField");
  const preview = document.getElementById("preview-card");
  const textButton = document.getElementById("textButton");
  const htmlButton = document.getElementById("htmlButton");

  [("keyup", "change", "input")].forEach((evt) =>
    nameInput.addEventListener(
      evt,
      () => (nameField.textContent = nameInput.value),
    ),
  );

  ["keyup", "change", "input"].forEach((evt) =>
    jobInput.addEventListener(
      evt,
      () => (jobField.textContent = jobInput.value),
    ),
  );

  ["keyup", "change", "input"].forEach((evt) =>
    emailInput.addEventListener(
      evt,
      () => (emailField.lastChild.nodeValue = " " + emailInput.value),
    ),
  );

  ["keyup", "change", "input"].forEach((evt) =>
    mobileInput.addEventListener(
      evt,
      () => (mobileField.lastChild.nodeValue = " +964-" + mobileInput.value),
    ),
  );

  ["keyup", "change", "input"].forEach((evt) =>
    skypeInput.addEventListener(
      evt,
      () => (skypeField.lastChild.nodeValue = " " + skypeInput.value),
    ),
  );

  textButton.addEventListener("click", () => {
    let element = preview;

    if (!element) {
      alert("Preview element not yet ready");
      return false;
    }

    if (document.body.createTextRange) {
      let range = document.body.createTextRange();
      range.moveToElementText(element.value);
      range.select();
      document.execCommand("copy");
    } else if (window.getSelection) {
      let selection = window.getSelection();
      let range = document.createRange();
      range.selectNodeContents(element);
      selection.removeAllRanges();
      selection.addRange(range);
      document.execCommand("copy");
      selection.removeAllRanges();
    }
  });

  htmlButton.addEventListener("click", () => {
    let element = preview;

    if (!element) {
      alert("Preview element not yet ready");
      return false;
    }

    const el = document.createElement("textarea");

    el.value = element.innerHTML;
    el.setAttribute("readonly", "");
    el.style.position = "absolute";
    el.style.left = "-9999px";
    document.body.appendChild(el);

    const selected =
      document.getSelection().rangeCount > 0
        ? document.getSelection().getRangeAt(0)
        : false;
    el.select();
    document.execCommand("copy");
    document.body.removeChild(el);
    if (selected) {
      document.getSelection().removeAllRanges();
      document.getSelection().addRange(selected);
    }
  });
</script>

<style>
  .main-wrap {
    padding-inline: 0.5rem;
    padding-block: 1.25rem;
    display: grid;
    gap: 0.5rem;
    grid-template:
      "form"
      "preview"
      "integrations" / 1fr;
  }

  @media (min-width: 950px) {
    .main-wrap {
      padding-inline: 10rem;
      gap: 0.25rem;
      grid-template:
        "form preview" 14rem
        "form integrations" / 1fr 1fr;
    }
  }

  h2 {
    font-size: var(--fs-sm);
    padding-block: 1.25rem;
    color: var(--on-surface);
  }

  .form {
    grid-area: form;
    padding-inline: 3rem;
    padding-block: 0.5rem;
  }

  form {
    display: grid;
    gap: 1.25rem;
  }
  .form-item {
    display: grid;
    gap: 0.5rem;
  }

  label {
    color: var(--on-surface);
    font-size: var(--fs-xs);
    font-weight: 600;
  }

  input {
    max-width: 100%;
    border: 1px solid var(--on-surface);
    padding: 0.5rem;
    color: var(--on-surface);
    background: var(--surface-container-high);
    border-radius: 0.5rem;
  }

  .error,
  .help {
    font-size: var(--fs-xs);
  }

  .error {
    color: var(--error);
  }

  .preview {
    padding-inline: 3rem;
    padding-block: 0.5rem;
    background: var(--surface);
    grid-area: preview;
  }

  .preview-card {
    background: var(--surface-container-light);
    padding: 0.5rem;
    max-width: max-content;
    border-radius: 0.5rem;
  }

  .integrations {
    grid-area: integrations;
    padding-inline: 3rem;
    padding-top: 0.25rem;
    padding-bottom: 1rem;
    background: var(--surface-container-high);
    border-radius: 0.5rem;
    margin-top: 1.75rem;
  }

  .integrations ol > li {
    font-size: var(--fs-sm);
    margin-left: 1.25rem;
    color: var(--on-surface);
  }

  .note {
    padding-inline: 1.25rem;
    margin-top: 1.25rem;
    border-left: 5px solid var(--primary-light);
  }

  .note > p {
    font-size: var(--fs-xs);
  }

  .btns {
    display: flex;
    gap: 0.5rem;
  }

  .btn {
    font-size: var(--fs-xs);
    color: var(--primary);
    font-weight: 600;
    padding-inline: 0.5rem;
    padding-block: 0.5rem;
    border-radius: 0.5rem;
    background: var(--surface-container);
    text-transform: uppercase;
    border: 1px solid var(--outline-variant);
  }
  .btn:hover,
  .btn:active {
    outline: none;
    cursor: pointer;
  }
  .btn:disabled {
    opacity: 0.8;
    cursor: not-allowed;
  }

  .primary-btn {
    color: var(--on-primary-container);
    background: var(--primary-container);
  }
  .secondary-btn {
    color: var(--on-tertiary-container);
    background: var(--tertiary-container);
  }
</style>
